{"version":3,"file":"HTTP.js","sources":["../../src/HTTP.ts"],"sourcesContent":["import { Client } from \"./Client\";\nimport { ServerError } from \"./errors/ServerError\";\nimport * as httpie from \"httpie\";\n\nexport class HTTP {\n    public authToken: string;\n\n    constructor(protected client: Client) {}\n\n    public get<T = any>(\n        path: string,\n        options: Partial<httpie.Options> = {}\n    ): Promise<httpie.Response<T>> {\n        return this.request(\"get\", path, options);\n    }\n\n    public post<T = any>(\n        path: string,\n        options: Partial<httpie.Options> = {}\n    ): Promise<httpie.Response<T>> {\n        return this.request(\"post\", path, options);\n    }\n\n    public del<T = any>(\n        path: string,\n        options: Partial<httpie.Options> = {}\n    ): Promise<httpie.Response<T>> {\n        return this.request(\"del\", path, options);\n    }\n\n    public put<T = any>(\n        path: string,\n        options: Partial<httpie.Options> = {}\n    ): Promise<httpie.Response<T>> {\n        return this.request(\"put\", path, options);\n    }\n\n    protected request(\n        method: \"get\" | \"post\" | \"put\" | \"del\",\n        path: string,\n        options: Partial<httpie.Options> = {}\n    ): Promise<httpie.Response> {\n        console.log(\"HTTP REQ : \", this.client[\"getHttpEndpoint\"](path));\n        return httpie[method](\n            this.client[\"getHttpEndpoint\"](path),\n            this.getOptions(options)\n        ).catch((e: any) => {\n            throw new ServerError(\n                e.statusCode || -1,\n                e.data?.error || e.statusMessage || e.message || \"offline\"\n            );\n        });\n    }\n\n    protected getOptions(options: Partial<httpie.Options>) {\n        if (this.authToken) {\n            if (!options.headers) {\n                options.headers = {};\n            }\n\n            options.headers[\"Authorization\"] = `Bearer ${this.authToken}`;\n            options.withCredentials = true;\n        }\n\n        return options;\n    }\n}\n"],"names":["httpie","ServerError"],"mappings":"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"}